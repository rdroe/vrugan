<!DOCTYPE html>
<head>
  <title>davo roe</title>
  <link href="stylesheets/vrugan.css" rel="stylesheet">   
  <meta name="viewport" content="minimum-scale=1">
  
  <meta name="viewport" content="maximum-scale=1">  
</head>
<body>
  <div class="body-bground">
    <img class="body-bground-img" src="/bground/assets/poly-settings.png">
  </div>
  <div class="container">
    <main>
      <div class="stage-view zero">
	<div class="stage-surface zero">
	  <div class="paper zero">
	    <h1>davo roe</h1>
	    <h3 class="text">ui, design, and backfrontend</h3>
	  </div>
	  <div class="divider zero"></div>
	</div>
      </div><!-- stage view -->
      
      <div class="stage-view one">
	<div class="stage-surface one">
	  <div class="paper one"><h1>dr</h1><div class="text"></div></div>
	 <div class="divider one"></div></div>
      </div><!-- stage view -->
      <div class="stage-view two">
	<div class="stage-surface two">
	 <div class="paper two">team player</div>
	 <div class="divider two"></div>
	</div>
      </div><!-- stage view -->
      <div class="stage-view three">
	<div class="stage-surface three">
	  <div class="penta">
	    <div class="penta-string">
	    <div class="side s-1">
	    </div>
	    <div class="side s-2">
	    </div>
	    <div class="side s-3">
	    </div>
	    <div class="side s-4">
	    </div>
	    <div class="side s-5">
	    </div>
	    </div>
	  </div>
	</div>
	</div>
    </main>
    <div class="rect top subgrid // -1"></div>
    <div class="rect side"></div>
    <div class="text one"></div>
    <div class="text two"></div>
  </div>
  <script type="module" src="/js/util/util.js"></script>
  <script type="module">

    import { tr } from './js/globals.js'
    import { qs } from '/js/util/util.js'
    import { vrug } from './js/vrug.js'
    import pentagonSpinner from './js/pentagonSpinner.js'
    const rangeEnds = [0]
    const rangeStarts = []
    const standardParentRange = 150
    const startRange  = (num) => {
	
	const prevEnd = rangeEnds[rangeEnds.length - 1]
	const start = num + prevEnd
	rangeStarts[rangeStarts.length] = start

	return `${start}vw`
    }

    const endRange = (num) => {
	const prevStart = rangeStarts[rangeStarts.length -1]
	const end = num + prevStart
	rangeEnds[rangeEnds.length] = end

	return `${end}vw`
    }

    const master = vrug('body')

    const follower0 = master
     .scrolls('.stage-view.zero')
 
    follower0
     .senses('v')
     .responds('v')
     .set('start', '0vw')
     .set('end', '30vw')
    .set('parentStart', startRange(100) )
    .set('parentEnd', endRange(standardParentRange))    
    .listen()
    
    
    follower0
     .senses('v')
     .responds('v')
     .set('start', '30vw')
     .set('end', '200vw')
    .set('parentStart', startRange(200))
    .set('parentEnd', endRange(standardParentRange + (.3* standardParentRange) ))
     .listen()

    const follower = master
     .scrolls('.stage-view.one')

    follower
     .senses('v')
     .responds('h')
     .set('start', '0vw')
     .set('end', '100vw')
    .set('parentStart', startRange(0) )
    .set('parentEnd', endRange(standardParentRange))
    .listen()

    follower    
    .senses('v')
    .responds('v')
     .set('start', '0vw')
     .set('end', '200vw')
    .set('parentStart', startRange(100) )
    .set('parentEnd', endRange(standardParentRange))
    .listen()


    const follower2 = master
	  .scrolls('.stage-view.two')
    
    follower2
     .senses('v')
     .responds('h')
     .set('start', '0vw')
     .set('end', '100vw')
    .set('parentStart', startRange(-60) )
    .set('parentEnd', endRange(standardParentRange) )
    .listen()
    
    follower2   
    .senses('v')
    .responds('v')
     .set('start', '0vw')
     .set('end', '200vw')
    .set('parentStart', startRange(100) )
    .set('parentEnd', endRange(standardParentRange) )
    .listen()

    const follower3 = master
	  .scrolls('.stage-view.three')
    
    follower3
     .senses('v')
     .responds('h')
     .set('start', '0vw')
     .set('end', '100vw')
    .set('parentStart', startRange(0) )
    .set('parentEnd', endRange(standardParentRange) )
    .listen()
 
    const follower4 = master
	  .scrolls('.penta-string')
    
    const penta = qs('.penta') 
    follower4
     .senses('v')
    .set('parentStart', startRange(-250) )
    .set('parentEnd', endRange(500) )
    .listen((pos, obj) => {

	const ps = obj.get('pixels', 'ps')
	const pe = obj.get('pixels', 'pe')
	const tot = pe - ps
	const progress = tr((pos - pe ) / tot * 1000) / 1000

	const el = obj.el
	
	const modPos1 =  pos % ( 360 * 150)
	const modPos = tr( modPos1 / (360* 10) * 360 *100 ) /100
	const to = 'center'
	const transform = `rotateZ(${modPos}deg)`
	el.style.transformOrigin = to
	el.style.transform = transform
	const colorOpac = 0 - progress * 1.6 
	penta.style.backgroundColor = `rgba(0,0,0, ${Math.min(.2, colorOpac)} )`

        penta.style.borderColor = `rgba(0,0,0, ${colorOpac} )` 
    })

    const pentas = document.querySelectorAll('.side')

    
    follower4
     .senses('v')
    .set('parentStart', startRange(0) )
    .set('parentEnd', endRange(3000) )
    .listen((pos, obj) => {
	pentagonSpinner(pentas, pos, obj)
    })
    
    follower0.init()
    follower.init() 
    follower2.init()
    follower3.init()
    follower4.init()

  </script>
</body>
