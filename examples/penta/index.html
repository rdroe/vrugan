A<!DOCTYPE html>
<head>
  <title>davo roe</title>
  <link href="stylesheets/vrugan.css" rel="stylesheet">   
  <meta name="viewport" content="minimum-scale=1">  
  <meta name="viewport" content="maximum-scale=1">  
</head>
<body>
  <div class="body-bground">
    <img class="body-bground-img" src="/bground/assets/poly-settings.png">
  </div>
  <div class="container">
    <main>
      <div class="stage-view paper-only">
	<div class="stage-surface paper-only">
	  <div class="paper"><div class="text">davo roe</div></div>
	</div>
      </div>
      <div class="stage-view">
	<div class="stage-surface">
	  <div class="paper penta">
	    <div class="penta-string">
  	     <div class="side s-1">
	     </div>
	     <div class="side s-2">
	     </div>
	     <div class="side s-3">
	     </div>
	     <div class="side s-4">
	     </div>
	     <div class="side s-5">
	     </div>
	    </div>
	  </div>
	</div>
	</div>
    </main>
  </div>
  <script type="module" src="/js/util/util.js"></script>
  <script type="module">

    import { util, tr, offsetter, postfixer } from '../../js/globals.js'
    import { qs } from '../../../js/util/util.js'
    import { vrug } from '../../js/vrug.js'
    import explodePenta, { rotatePenta } from '../../js/explodePenta.js'

    const ranges = offsetter()
    const vhStartPoint = postfixer(ranges.startPoint, 'vh')
    const vhEndPoint = postfixer(ranges.endPoint, 'vh')

    const addVh = (str, num) => {
	return `${num + parseInt(str, 10) }vh`
    }

    const master = vrug('body')
    
    const follower = master
	  .addScroller('.stage-view.paper-only')

    const initPentaWidth = (n) => {
	const initAmt =  util('5vw').toPx()
	const amt =  Math.max( initAmt, 15  );
	return amt;
    }

    const scrollOnscreen = vhStartPoint(50)
    const scrollOnscreenEnd = vhEndPoint(125)

    const scrollOffscreen = addVh(scrollOnscreenEnd, 1200)
    const scrollOffscreenEnd = addVh(scrollOffscreen, 200)
   
    const astScrollStart = addVh(scrollOnscreenEnd, 0)
    const astScrollEnd = addVh(astScrollStart, 175)

    const startSpread = addVh(astScrollEnd, 300)
    const endSpread = addVh(startSpread, 150)

    const rotateOneStart = astScrollEnd
    const rotateOneEnd = addVh(endSpread, 200)

    const explodeStart = rotateOneEnd
    const explodeEnd = addVh(rotateOneEnd, 350)
   
    // Coming onstage
    follower    
    .addDirection('v', 0, 100, parseInt(scrollOnscreen), parseInt(scrollOnscreenEnd))

    // scrolling off
    follower
          .addDirection('v', 100, 200, parseInt(scrollOffscreen), parseInt(scrollOffscreenEnd))

    // asterisk scrolls onscreen
    const follower4pre = master
	  .addScroller('.stage-view:not(.paper-only)')

    follower4pre
    .addDirection('v', 0, 100, parseInt(astScrollStart, 10), parseInt(astScrollEnd, 10))

    // asterisk spreads
    const pentas = document.querySelectorAll('.side')

    follower4pre
    .senses('v')
    // match the first one
    .set('parentStart',  addVh(startSpread, 0))
    // match the first one
    .set('parentEnd', addVh(endSpread, 0))
    .listen((pos, obj) => {
	return explodePenta(pentas, pos, obj, 0, initPentaWidth()  )
    })

    const follower4 = master
	  .scrolls('.penta-string')
    
    const pentaState = {}
    const penta = qs('.penta')

    // Pentagon rotation only
    follower4
      .senses('v')
      .set('parentStart', rotateOneStart  )
      .set('parentEnd', rotateOneEnd )
      .listen(rotatePenta)

    follower4
    .senses('v')
    // flies apart
    .set('parentStart', explodeStart )    
    .set('parentEnd', explodeEnd  )
    .listen((pos, obj) => {

	if (pos < obj.get('pixels','ps' ) ) {
	    return
	}

        return explodePenta(pentas, pos, obj, initPentaWidth() , 900) 
    })
   
    follower.init()
    follower4pre.init()
    follower4.init()

  </script>
</body>
